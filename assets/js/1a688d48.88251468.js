"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[7211],{3881:(e,n,r)=>{r.d(n,{R:()=>o,x:()=>t});var s=r(8101);const c={},l=s.createContext(c);function o(e){const n=s.useContext(l);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:o(e.components),s.createElement(l.Provider,{value:n},e.children)}},9802:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>i,contentTitle:()=>t,default:()=>h,frontMatter:()=>o,metadata:()=>s,toc:()=>a});const s=JSON.parse('{"id":"\u524d\u7aef/EcmaScript/EcmaScript2015/Promise \u5bf9\u8c61/index","title":"Promise \u65b9\u6cd5","description":"\ud83d\ude80 Promise \u7684\u542b\u4e49\uff1aPromise \u662f\u5f02\u6b65\u7f16\u7a0b\u7684\u4e00\u79cd\u89e3\u51b3\u65b9\u6848\u3002","source":"@site/docs/\u524d\u7aef/EcmaScript/EcmaScript2015/Promise \u5bf9\u8c61/index.mdx","sourceDirName":"\u524d\u7aef/EcmaScript/EcmaScript2015/Promise \u5bf9\u8c61","slug":"/\u524d\u7aef/EcmaScript/EcmaScript2015/Promise \u5bf9\u8c61/","permalink":"/docs/\u524d\u7aef/EcmaScript/EcmaScript2015/Promise \u5bf9\u8c61/","draft":false,"unlisted":false,"editUrl":"https://github.com/docs/\u524d\u7aef/EcmaScript/EcmaScript2015/Promise \u5bf9\u8c61/index.mdx","tags":[],"version":"current","frontMatter":{},"sidebar":"\u524d\u7aef","previous":{"title":"Module \u7684\u8bed\u6cd5","permalink":"/docs/\u524d\u7aef/EcmaScript/EcmaScript2015/Module \u7684\u8bed\u6cd5/"},"next":{"title":"Proxy","permalink":"/docs/\u524d\u7aef/EcmaScript/EcmaScript2015/Proxy \u5bf9\u8c61/"}}');var c=r(5105),l=r(3881);const o={},t="Promise \u65b9\u6cd5",i={},a=[{value:"\u7279\u70b9",id:"\u7279\u70b9",level:2},{value:"\u57fa\u672c\u7528\u6cd5",id:"\u57fa\u672c\u7528\u6cd5",level:2},{value:"then",id:"then",level:2},{value:"catch",id:"catch",level:2},{value:"finally",id:"finally",level:2},{value:"all",id:"all",level:2},{value:"race",id:"race",level:2},{value:"allSettled",id:"allsettled",level:2},{value:"any",id:"any",level:2},{value:"resolve",id:"resolve",level:2},{value:"reject",id:"reject",level:2},{value:"try",id:"try",level:2},{value:"\u5e94\u7528",id:"\u5e94\u7528",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,l.R)(),...e.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(n.header,{children:(0,c.jsx)(n.h1,{id:"promise-\u65b9\u6cd5",children:"Promise \u65b9\u6cd5"})}),"\n",(0,c.jsx)(n.p,{children:"\ud83d\ude80 Promise \u7684\u542b\u4e49\uff1aPromise \u662f\u5f02\u6b65\u7f16\u7a0b\u7684\u4e00\u79cd\u89e3\u51b3\u65b9\u6848\u3002"}),"\n",(0,c.jsx)(n.p,{children:"Promise \u5bf9\u8c61\u662f\u4e00\u4e2a\u6784\u9020\u51fd\u6570\u3002\u5bf9\u8c61\u4ee3\u8868\u4e00\u4e2a\u5f02\u6b65\u64cd\u4f5c\uff0c\u6709\u4e09\u79cd\u72b6\u6001\uff1apending\uff08\u8fdb\u884c\u4e2d\uff09\u3001fulfilled\uff08\u5df2\u6210\u529f\uff09\u548c rejected\uff08\u5df2\u5931\u8d25\uff09\u3002"}),"\n",(0,c.jsx)(n.h2,{id:"\u7279\u70b9",children:"\u7279\u70b9"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"new Promise \u65b0\u5efa\u540e\u5c31\u4f1a\u7acb\u5373\u6267\u884c\u3002"}),"\n",(0,c.jsx)(n.li,{children:"\u65e0\u6cd5\u53d6\u6d88 Promise\u3002"}),"\n",(0,c.jsx)(n.li,{children:"\u4e0d\u8bbe\u7f6e\u56de\u8c03\u51fd\u6570\uff0c\u5185\u90e8\u629b\u51fa\u7684\u9519\u8bef\u4e0d\u4f1a\u53cd\u5e94\u5230\u5916\u90e8\u3002"}),"\n"]}),"\n",(0,c.jsx)(n.h2,{id:"\u57fa\u672c\u7528\u6cd5",children:"\u57fa\u672c\u7528\u6cd5"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-Javascript",children:"const promise = new Promise(function (resolve, reject) {});\n"})}),"\n",(0,c.jsx)(n.h2,{id:"then",children:"then"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-Javascript",children:"promise.then(\n  function (value) {\n    // success\n  },\n  function (error) {\n    // failure\n  }\n);\n"})}),"\n",(0,c.jsx)(n.h2,{id:"catch",children:"catch"}),"\n",(0,c.jsx)(n.p,{children:"\u4e00\u822c\u6765\u8bf4\uff0c\u4e0d\u4f7f\u7528 then()\u65b9\u6cd5\u7684\u7b2c\u4e8c\u4e2a\u53c2\u6570\u3002\uff0c\u603b\u662f\u4f7f\u7528 catch \u65b9\u6cd5\u3002\u629b\u51fa\u7684\u9519\u8bef\u4e0d\u4f1a\u4f20\u9012\u5230\u5916\u5c42\u4ee3\u7801\uff0c\u201cPromise \u4f1a\u5403\u6389\u9519\u8bef\u201d\u3002"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-Javascript",children:"promise\n  .then(function (data) {\n    //cb\n    // success\n  })\n  .catch(function (err) {\n    // error\n  });\n"})}),"\n",(0,c.jsx)(n.h2,{id:"finally",children:"finally"}),"\n",(0,c.jsx)(n.p,{children:"\u4e0d\u7ba1 Promise \u5bf9\u8c61\u6700\u540e\u72b6\u6001\u5982\u4f55\uff0c\u90fd\u4f1a\u6267\u884c\u7684\u64cd\u4f5c\u3002"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-Javascript",children:"promise.then(result => {})\n  .catch(error => {})\n  .finally(() => {});\n"})}),"\n",(0,c.jsx)(n.p,{children:"\u6e90\u7801\u5b9e\u73b0\u539f\u7406\u3002"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-Javascript",children:"Promise.prototype.finally = function (callback) {\n  let P = this.constructor;\n  return this.then(\n    (value) => P.resolve(callback()).then(() => value),\n    (reason) =>\n      P.resolve(callback()).then(() => {\n        throw reason;\n      })\n  );\n};\n"})}),"\n",(0,c.jsx)(n.h2,{id:"all",children:"all"}),"\n",(0,c.jsx)(n.p,{children:"\u7b49\u5f85\u5168\u90e8\u8bf7\u6c42\u90fd\u6210\u529f\uff0c\u5219\u6210\u529f\uff0c\u5426\u5219\u5931\u8d25 \u6ca1\u6709\u81ea\u5df1\u7684 catch \u65b9\u6cd5\uff0c\u5c31\u4f1a\u8c03\u7528 Promise.all()\u7684 catch \u65b9\u6cd5\u3002"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-Javascript",children:'const resolved = Promise.resolve(42);\nconst rejected = new Promise(function (resolve, reject) {\n  setTimeout(() => {\n    console.log("\u8bf7\u6c42\u662f\u5426\u505c\u6b62");\n    reject(-1);\n  }, 3000);\n});\n\nconst promise = Promise.all([resolved, rejected]);\n\npromise.then(function (results) {\n  console.log(results);\n}).catch(error => {})\n'})}),"\n",(0,c.jsx)(n.h2,{id:"race",children:"race"}),"\n",(0,c.jsx)(n.p,{children:"\u4e00\u65e6\u6709\u7ed3\u679c\uff0c\u8fd4\u56de\u5f53\u524d\u72b6\u6001\u3002\u4e0d\u5f71\u54cd\u5176\u4ed6\u8bf7\u6c42"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-Javascript",children:'const resolved = Promise.resolve(42);\nconst rejected = new Promise(function (resolve, reject) {\n  setTimeout(() => {\n    console.log("\u8bf7\u6c42\u662f\u5426\u505c\u6b62");\n    reject(-1);\n  }, 3000);\n});\n\nconst promise = Promise.race([resolved, rejected]);\n\npromise.then(function (results) {\n  console.log(results);\n});\n'})}),"\n",(0,c.jsx)(n.h2,{id:"allsettled",children:"allSettled"}),"\n",(0,c.jsx)(n.p,{children:"\u5f02\u6b65\u64cd\u4f5c\u662f\u5426\u90fd\u7ed3\u675f\uff0c\u8fd4\u56de\u72b6\u6001\u7ec4"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-Javascript",children:"const resolved = Promise.resolve(42);\nconst rejected = Promise.reject(-1);\nconst promise = Promise.allSettled([resolved, rejected]);\n\npromise.then(function (results) {\n  console.log(results);\n});\n// [\n//    { status: 'fulfilled', value: 42 },\n//    { status: 'rejected', reason: -1 }\n// ]\n"})}),"\n",(0,c.jsx)(n.h2,{id:"any",children:"any"}),"\n",(0,c.jsx)(n.p,{children:"\u6709\u4e00\u4e2a\u6210\u529f\uff0c\u8fd4\u56de\u6210\u529f\uff0c\u90fd\u5931\u8d25\uff0c\u8fd4\u56de\u5931\u8d25"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-Javascript",children:"var resolved = Promise.resolve(42);\nvar rejected = Promise.reject(-1);\nvar alsoRejected = Promise.reject(Infinity);\n\nPromise.any([resolved, rejected, alsoRejected]).then(function (result) {\n  console.log(result); // 42\n});\n\nPromise.any([rejected, alsoRejected]).catch(function (results) {\n  console.log(results instanceof AggregateError); // true\n  console.log(results.errors); // [-1, Infinity]\n});\n"})}),"\n",(0,c.jsx)(n.h2,{id:"resolve",children:"resolve"}),"\n",(0,c.jsx)(n.p,{children:"\u8f6c\u4e3a Promise \u5bf9\u8c61\uff0c\u7136\u540e\u5c31\u7acb\u5373\u6267\u884c thenable \u5bf9\u8c61\u7684 then() \u65b9\u6cd5\u3002"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-Javascript",children:'Promise.resolve("foo");\n// \u7b49\u4ef7\u4e8e\nnew Promise((resolve) => resolve("foo"));\n'})}),"\n",(0,c.jsx)(n.h2,{id:"reject",children:"reject"}),"\n",(0,c.jsx)(n.p,{children:"\u8fd4\u56de\u4e00\u4e2a\u65b0\u7684 Promise \u5b9e\u4f8b\uff0c\u72b6\u6001\u4e3a rejected\uff0c\u56de\u8c03\u51fd\u6570\u4f1a\u7acb\u5373\u6267\u884c\u3002"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-Javascript",children:'const p = Promise.reject("\u51fa\u9519\u4e86");\n// \u7b49\u540c\u4e8e\nconst p = new Promise((resolve, reject) => reject("\u51fa\u9519\u4e86"));\n'})}),"\n",(0,c.jsx)(n.h2,{id:"try",children:"try"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-Javascript",children:'const f = () => console.log("now");\n(() => new Promise((resolve) => resolve(f())))();\nconsole.log("next");\n// now\n// next\n\n// \u63d0\u4f9bPromise.try\u65b9\u6cd5\u66ff\u4ee3\u4e0a\u9762\u7684\u5199\u6cd5\u3002\n\nconst f = () => console.log("now");\nPromise.try(f);\nconsole.log("next");\n// now\n// next\n'})}),"\n",(0,c.jsx)(n.h2,{id:"\u5e94\u7528",children:"\u5e94\u7528"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-Javascript",children:"const preloadImage = function (path) {\n  return new Promise(function (resolve, reject) {\n    const image = new Image();\n    image.onload = resolve;\n    image.onerror = reject;\n    image.src = path;\n  });\n};\n"})})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,c.jsx)(n,{...e,children:(0,c.jsx)(d,{...e})}):d(e)}}}]);