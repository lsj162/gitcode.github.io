"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([["5545"],{35062:function(e,n,r){r.r(n),r.d(n,{frontMatter:()=>i,default:()=>h,contentTitle:()=>o,assets:()=>t,toc:()=>a,metadata:()=>s});var s=JSON.parse('{"id":"\u524D\u7AEF/JavaScript/API \u7D22\u5F15/EcmaScript 2015/Promise \u5BF9\u8C61/index","title":"Promise \u65B9\u6CD5","description":"\uD83D\uDE80 Promise \u7684\u542B\u4E49\uFF1APromise \u662F\u5F02\u6B65\u7F16\u7A0B\u7684\u4E00\u79CD\u89E3\u51B3\u65B9\u6848\u3002","source":"@site/docs/\u524D\u7AEF/JavaScript/API \u7D22\u5F15/EcmaScript 2015/Promise \u5BF9\u8C61/index.mdx","sourceDirName":"\u524D\u7AEF/JavaScript/API \u7D22\u5F15/EcmaScript 2015/Promise \u5BF9\u8C61","slug":"/\u524D\u7AEF/JavaScript/API \u7D22\u5F15/EcmaScript 2015/Promise \u5BF9\u8C61/","permalink":"/docs/\u524D\u7AEF/JavaScript/API \u7D22\u5F15/EcmaScript 2015/Promise \u5BF9\u8C61/","draft":false,"unlisted":false,"editUrl":"https://github.com/docs/\u524D\u7AEF/JavaScript/API \u7D22\u5F15/EcmaScript 2015/Promise \u5BF9\u8C61/index.mdx","tags":[],"version":"current","frontMatter":{},"sidebar":"\u524D\u7AEF","previous":{"title":"Module \u7684\u8BED\u6CD5","permalink":"/docs/\u524D\u7AEF/JavaScript/API \u7D22\u5F15/EcmaScript 2015/Module \u7684\u8BED\u6CD5/"},"next":{"title":"Proxy","permalink":"/docs/\u524D\u7AEF/JavaScript/API \u7D22\u5F15/EcmaScript 2015/Proxy \u5BF9\u8C61/"}}'),l=r(96773),c=r(16070);let i={},o="Promise \u65B9\u6CD5",t={},a=[{value:"\u7279\u70B9",id:"\u7279\u70B9",level:2},{value:"\u57FA\u672C\u7528\u6CD5",id:"\u57FA\u672C\u7528\u6CD5",level:2},{value:"then",id:"then",level:2},{value:"catch",id:"catch",level:2},{value:"finally",id:"finally",level:2},{value:"all",id:"all",level:2},{value:"race",id:"race",level:2},{value:"allSettled",id:"allsettled",level:2},{value:"any",id:"any",level:2},{value:"resolve",id:"resolve",level:2},{value:"reject",id:"reject",level:2},{value:"try",id:"try",level:2},{value:"\u5E94\u7528",id:"\u5E94\u7528",level:2}];function d(e){let n={code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,c.a)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"promise-\u65B9\u6CD5",children:"Promise \u65B9\u6CD5"})}),"\n",(0,l.jsx)(n.p,{children:"\uD83D\uDE80 Promise \u7684\u542B\u4E49\uFF1APromise \u662F\u5F02\u6B65\u7F16\u7A0B\u7684\u4E00\u79CD\u89E3\u51B3\u65B9\u6848\u3002"}),"\n",(0,l.jsx)(n.p,{children:"Promise \u5BF9\u8C61\u662F\u4E00\u4E2A\u6784\u9020\u51FD\u6570\u3002\u5BF9\u8C61\u4EE3\u8868\u4E00\u4E2A\u5F02\u6B65\u64CD\u4F5C\uFF0C\u6709\u4E09\u79CD\u72B6\u6001\uFF1Apending\uFF08\u8FDB\u884C\u4E2D\uFF09\u3001fulfilled\uFF08\u5DF2\u6210\u529F\uFF09\u548C rejected\uFF08\u5DF2\u5931\u8D25\uFF09\u3002"}),"\n",(0,l.jsx)(n.h2,{id:"\u7279\u70B9",children:"\u7279\u70B9"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"new Promise \u65B0\u5EFA\u540E\u5C31\u4F1A\u7ACB\u5373\u6267\u884C\u3002"}),"\n",(0,l.jsx)(n.li,{children:"\u65E0\u6CD5\u53D6\u6D88 Promise\u3002"}),"\n",(0,l.jsx)(n.li,{children:"\u4E0D\u8BBE\u7F6E\u56DE\u8C03\u51FD\u6570\uFF0C\u5185\u90E8\u629B\u51FA\u7684\u9519\u8BEF\u4E0D\u4F1A\u53CD\u5E94\u5230\u5916\u90E8\u3002"}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"\u57FA\u672C\u7528\u6CD5",children:"\u57FA\u672C\u7528\u6CD5"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-Javascript",children:"const promise = new Promise(function (resolve, reject) {});\n"})}),"\n",(0,l.jsx)(n.h2,{id:"then",children:"then"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-Javascript",children:"promise.then(\n  function (value) {\n    // success\n  },\n  function (error) {\n    // failure\n  }\n);\n"})}),"\n",(0,l.jsx)(n.h2,{id:"catch",children:"catch"}),"\n",(0,l.jsx)(n.p,{children:"\u4E00\u822C\u6765\u8BF4\uFF0C\u4E0D\u4F7F\u7528 then()\u65B9\u6CD5\u7684\u7B2C\u4E8C\u4E2A\u53C2\u6570\u3002\uFF0C\u603B\u662F\u4F7F\u7528 catch \u65B9\u6CD5\u3002\u629B\u51FA\u7684\u9519\u8BEF\u4E0D\u4F1A\u4F20\u9012\u5230\u5916\u5C42\u4EE3\u7801\uFF0C\u201CPromise \u4F1A\u5403\u6389\u9519\u8BEF\u201D\u3002"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-Javascript",children:"promise\n  .then(function (data) {\n    //cb\n    // success\n  })\n  .catch(function (err) {\n    // error\n  });\n"})}),"\n",(0,l.jsx)(n.h2,{id:"finally",children:"finally"}),"\n",(0,l.jsx)(n.p,{children:"\u4E0D\u7BA1 Promise \u5BF9\u8C61\u6700\u540E\u72B6\u6001\u5982\u4F55\uFF0C\u90FD\u4F1A\u6267\u884C\u7684\u64CD\u4F5C\u3002"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-Javascript",children:"promise.then(result => {})\n  .catch(error => {})\n  .finally(() => {});\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u6E90\u7801\u5B9E\u73B0\u539F\u7406\u3002"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-Javascript",children:"Promise.prototype.finally = function (callback) {\n  let P = this.constructor;\n  return this.then(\n    (value) => P.resolve(callback()).then(() => value),\n    (reason) =>\n      P.resolve(callback()).then(() => {\n        throw reason;\n      })\n  );\n};\n"})}),"\n",(0,l.jsx)(n.h2,{id:"all",children:"all"}),"\n",(0,l.jsx)(n.p,{children:"\u7B49\u5F85\u5168\u90E8\u8BF7\u6C42\u90FD\u6210\u529F\uFF0C\u5219\u6210\u529F\uFF0C\u5426\u5219\u5931\u8D25 \u6CA1\u6709\u81EA\u5DF1\u7684 catch \u65B9\u6CD5\uFF0C\u5C31\u4F1A\u8C03\u7528 Promise.all()\u7684 catch \u65B9\u6CD5\u3002"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-Javascript",children:'const resolved = Promise.resolve(42);\nconst rejected = new Promise(function (resolve, reject) {\n  setTimeout(() => {\n    console.log("\u8BF7\u6C42\u662F\u5426\u505C\u6B62");\n    reject(-1);\n  }, 3000);\n});\n\nconst promise = Promise.all([resolved, rejected]);\n\npromise.then(function (results) {\n  console.log(results);\n}).catch(error => {})\n'})}),"\n",(0,l.jsx)(n.h2,{id:"race",children:"race"}),"\n",(0,l.jsx)(n.p,{children:"\u4E00\u65E6\u6709\u7ED3\u679C\uFF0C\u8FD4\u56DE\u5F53\u524D\u72B6\u6001\u3002\u4E0D\u5F71\u54CD\u5176\u4ED6\u8BF7\u6C42"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-Javascript",children:'const resolved = Promise.resolve(42);\nconst rejected = new Promise(function (resolve, reject) {\n  setTimeout(() => {\n    console.log("\u8BF7\u6C42\u662F\u5426\u505C\u6B62");\n    reject(-1);\n  }, 3000);\n});\n\nconst promise = Promise.race([resolved, rejected]);\n\npromise.then(function (results) {\n  console.log(results);\n});\n'})}),"\n",(0,l.jsx)(n.h2,{id:"allsettled",children:"allSettled"}),"\n",(0,l.jsx)(n.p,{children:"\u5F02\u6B65\u64CD\u4F5C\u662F\u5426\u90FD\u7ED3\u675F\uFF0C\u8FD4\u56DE\u72B6\u6001\u7EC4"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-Javascript",children:"const resolved = Promise.resolve(42);\nconst rejected = Promise.reject(-1);\nconst promise = Promise.allSettled([resolved, rejected]);\n\npromise.then(function (results) {\n  console.log(results);\n});\n// [\n//    { status: 'fulfilled', value: 42 },\n//    { status: 'rejected', reason: -1 }\n// ]\n"})}),"\n",(0,l.jsx)(n.h2,{id:"any",children:"any"}),"\n",(0,l.jsx)(n.p,{children:"\u6709\u4E00\u4E2A\u6210\u529F\uFF0C\u8FD4\u56DE\u6210\u529F\uFF0C\u90FD\u5931\u8D25\uFF0C\u8FD4\u56DE\u5931\u8D25"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-Javascript",children:"var resolved = Promise.resolve(42);\nvar rejected = Promise.reject(-1);\nvar alsoRejected = Promise.reject(Infinity);\n\nPromise.any([resolved, rejected, alsoRejected]).then(function (result) {\n  console.log(result); // 42\n});\n\nPromise.any([rejected, alsoRejected]).catch(function (results) {\n  console.log(results instanceof AggregateError); // true\n  console.log(results.errors); // [-1, Infinity]\n});\n"})}),"\n",(0,l.jsx)(n.h2,{id:"resolve",children:"resolve"}),"\n",(0,l.jsx)(n.p,{children:"\u8F6C\u4E3A Promise \u5BF9\u8C61\uFF0C\u7136\u540E\u5C31\u7ACB\u5373\u6267\u884C thenable \u5BF9\u8C61\u7684 then() \u65B9\u6CD5\u3002"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-Javascript",children:'Promise.resolve("foo");\n// \u7B49\u4EF7\u4E8E\nnew Promise((resolve) => resolve("foo"));\n'})}),"\n",(0,l.jsx)(n.h2,{id:"reject",children:"reject"}),"\n",(0,l.jsx)(n.p,{children:"\u8FD4\u56DE\u4E00\u4E2A\u65B0\u7684 Promise \u5B9E\u4F8B\uFF0C\u72B6\u6001\u4E3A rejected\uFF0C\u56DE\u8C03\u51FD\u6570\u4F1A\u7ACB\u5373\u6267\u884C\u3002"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-Javascript",children:'const p = Promise.reject("\u51FA\u9519\u4E86");\n// \u7B49\u540C\u4E8E\nconst p = new Promise((resolve, reject) => reject("\u51FA\u9519\u4E86"));\n'})}),"\n",(0,l.jsx)(n.h2,{id:"try",children:"try"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-Javascript",children:'const f = () => console.log("now");\n(() => new Promise((resolve) => resolve(f())))();\nconsole.log("next");\n// now\n// next\n\n// \u63D0\u4F9BPromise.try\u65B9\u6CD5\u66FF\u4EE3\u4E0A\u9762\u7684\u5199\u6CD5\u3002\n\nconst f = () => console.log("now");\nPromise.try(f);\nconsole.log("next");\n// now\n// next\n'})}),"\n",(0,l.jsx)(n.h2,{id:"\u5E94\u7528",children:"\u5E94\u7528"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-Javascript",children:"const preloadImage = function (path) {\n  return new Promise(function (resolve, reject) {\n    const image = new Image();\n    image.onload = resolve;\n    image.onerror = reject;\n    image.src = path;\n  });\n};\n"})})]})}function h(e={}){let{wrapper:n}={...(0,c.a)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(d,{...e})}):d(e)}}}]);